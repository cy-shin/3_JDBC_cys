<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
<properties>

	<comment>box-query.xml file</comment>
	
	<!-- 유저 확인  -->
	<entry key = "msgUserCheck">
		SELECT USER_NO FROM "USER" 
		WHERE USER_NAME = ?
	</entry>
	
	<!-- 메세지 번호 생성 -->
	<entry key = "makeMsgNo">
		SELECT MSG_NO FROM MSG_BOX
		WHERE MSG_NO = ?
	</entry>
	
	<!-- 메세지 저장 -->
	<entry key = "insertMsgBox">
		INSERT INTO MSG_BOX 
		VALUES(?, DEFAULT, ?, ?)
	</entry>
	
	<!-- 메세지 전송기록 -->
	<entry key = "insertMsgSend">
		INSERT INTO MSG_SEND
		VALUES(?, ?, DEFAULT)
	</entry>
	
	<!-- 메세지 수신기록 -->
	<entry key = "insertMsgRecd">
		INSERT INTO MSG_RECD
		VALUES(?, ?, DEFAULT, DEFAULT, DEFAULT)
	</entry>
	
	<!-- 받은 메시지함  -->
	<entry key = "msgBoxRecd">
		SELECT (SELECT USER_NAME FROM "USER" SUB
				WHERE SUB.USER_NO = SEND.USER_NO) USER_NAME, 
				TITLE, MSG_DATE, READ_FL
		FROM MSG_BOX BOX 
		LEFT JOIN MSG_SEND SEND ON(BOX.MSG_NO = SEND.MSG_NO)
		LEFT JOIN MSG_RECD RECD ON(BOX.MSG_NO = RECD.MSG_NO)
		LEFT JOIN "USER" U ON(U.USER_NO = RECD.USER_NO)
		WHERE  RDEL_FL = 'F'
		AND RECD.USER_NO = ?
	</entry>
	
	<!-- 보낸 메시지함  -->
	<entry key = "msgBoxSend">
		SELECT (SELECT USER_NAME FROM "USER" SUB
				WHERE SUB.USER_NO = RECD.USER_NO) USER_NAME, 
				TITLE, MSG_DATE
		FROM MSG_BOX BOX 
		LEFT JOIN MSG_SEND SEND ON(BOX.MSG_NO = SEND.MSG_NO)
		LEFT JOIN MSG_RECD RECD ON(BOX.MSG_NO = RECD.MSG_NO)
		LEFT JOIN "USER" U ON(U.USER_NO = RECD.USER_NO)
		WHERE  SDEL_FL = 'F'
		AND SEND.USER_NO = ?
	</entry>
	
</properties>
